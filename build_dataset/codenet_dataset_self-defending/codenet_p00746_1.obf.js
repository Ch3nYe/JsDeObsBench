var a0_0x8b1d8b=(function(){var firstCall=!![];return function(context,fn){var rfn=firstCall?function(){if(fn){var res=fn['apply'](context,arguments);fn=null;return res;}}:function(){};firstCall=![];return rfn;};}());var a0_0xd6c213=a0_0x8b1d8b(this,function(){return a0_0xd6c213['toString']()['search']('(((.+)+)+)+$')['toString']()['constructor'](a0_0xd6c213)['search']('(((.+)+)+)+$');});a0_0xd6c213();var input=require('fs')['readFileSync']('/dev/stdin','utf8');var Arr=input['trim']()['split']('\x0a');while(!![]){var N=Arr['shift']()-0x0;if(N==0x0)break;if(N==0x1){console['log']('1\x201');continue;}var arr=[];arr[0x0]=[0x0,0x0];for(var i=0x0;i<N-0x1;i++){var nm=Arr['shift']()['split']('\x20')['map'](Number);var n=nm[0x0];var m=nm[0x1];var x=0x0;var y=0x0;if(m==0x0)x=-0x1;if(m==0x1)y=-0x1;if(m==0x2)x=0x1;if(m==0x3)y=0x1;arr[i+0x1]=[arr[n][0x0]+x,arr[n][0x1]+y];}var xA=0x0;var xZ=0x0;var yA=0x0;var yZ=0x0;for(var i=0x0;i<arr['length'];i++){xA=Math['min'](xA,arr[i][0x0]);xZ=Math['max'](xZ,arr[i][0x0]);yA=Math['min'](yA,arr[i][0x1]);yZ=Math['max'](yZ,arr[i][0x1]);}console['log'](xZ-xA+0x1+'\x20'+(yZ-yA+0x1));}