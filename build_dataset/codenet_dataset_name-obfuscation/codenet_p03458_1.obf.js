function Main(_0x1f3e41) {
    _0x1f3e41 = _0x1f3e41['split']('\x0a');
    var _0xa2189e = _0x1f3e41[0x0]['split']('\x20')['map'](_0x3772c3 => parseInt(_0x3772c3));
    var _0x40a565 = _0xa2189e[0x1];
    _0xa2189e = _0xa2189e[0x0];
    var _0x4dcd5a = [], _0x2ca3fb = [], _0x4870a1 = [];
    for (var _0x257b3a = 0x0; _0x257b3a < _0xa2189e; _0x257b3a++) {
        _0x4dcd5a[_0x257b3a] = _0x1f3e41[_0x257b3a + 0x1]['split']('\x20');
        _0x2ca3fb[_0x257b3a] = parseInt(_0x4dcd5a[_0x257b3a][0x1]) % (_0x40a565 * 0x2);
        _0x4870a1[_0x257b3a] = _0x4dcd5a[_0x257b3a][0x2] === 'W' ? 0x0 : 0x1;
        _0x4dcd5a[_0x257b3a] = parseInt(_0x4dcd5a[_0x257b3a][0x0]) % (_0x40a565 * 0x2);
    }
    var _0x3286a0 = 0x0;
    for (_0x257b3a = 0x0; _0x257b3a < _0x40a565; _0x257b3a++) {
        var _0x1b53b1 = 0x0;
        var _0x6db048 = new Array(_0x40a565 * 0x2)['fill'](0x0), _0x31fd91 = new Array(_0x40a565 * 0x2)['fill'](0x0);
        for (var _0x3e05bf = 0x0; _0x3e05bf < _0xa2189e; _0x3e05bf++) {
            if ((((_0x4dcd5a[_0x3e05bf] + _0x257b3a) / _0x40a565 ^ _0x2ca3fb[_0x3e05bf] / _0x40a565) & 0x1) === _0x4870a1[_0x3e05bf]) {
                _0x1b53b1++;
                _0x6db048[_0x2ca3fb[_0x3e05bf]]++;
            } else
                _0x31fd91[_0x2ca3fb[_0x3e05bf]]++;
        }
        if (_0x3286a0 < _0x1b53b1)
            _0x3286a0 = _0x1b53b1;
        if (_0x3286a0 < _0xa2189e - _0x1b53b1)
            _0x3286a0 = _0xa2189e - _0x1b53b1;
        for (var _0xe43c99 = 0x0; _0xe43c99 < _0x40a565 - 0x1; _0xe43c99++) {
            _0x1b53b1 += _0x31fd91[_0xe43c99] - _0x6db048[_0xe43c99] + _0x31fd91[_0xe43c99 + _0x40a565] - _0x6db048[_0xe43c99 + _0x40a565];
            if (_0x3286a0 < _0x1b53b1)
                _0x3286a0 = _0x1b53b1;
            if (_0x3286a0 < _0xa2189e - _0x1b53b1)
                _0x3286a0 = _0xa2189e - _0x1b53b1;
        }
    }
    console['log'](_0x3286a0);
}
Main(require('fs')['readFileSync']('/dev/stdin', 'utf8'));