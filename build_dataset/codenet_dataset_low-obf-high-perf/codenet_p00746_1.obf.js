function a0_0x3106(){var _0x39fe85=['35523xsaTSV','491282nnOuxc','640198EjwsdX','1904065MZDqLA','utf8','1\x201','(((.+)+)+)+$','search','7XXYWYk','map','shift','1093660BnzIoF','2099312xZBemS','length','log','3kEKxOJ','max','split','4379142mVGVQA','min','toString','1010WTLvNV','apply'];a0_0x3106=function(){return _0x39fe85;};return a0_0x3106();}function a0_0x50ab(_0x1d50c7,_0x21b082){var _0x669288=a0_0x3106();return a0_0x50ab=function(_0x46f769,_0x3e2e41){_0x46f769=_0x46f769-0xc8;var _0x31069b=_0x669288[_0x46f769];return _0x31069b;},a0_0x50ab(_0x1d50c7,_0x21b082);}var a0_0x15992f=a0_0x50ab;(function(_0x15a87a,_0x41a550){var _0x2a3f6a=a0_0x50ab,_0x154ebb=_0x15a87a();while(!![]){try{var _0x2f81ee=parseInt(_0x2a3f6a(0xcb))/0x1+parseInt(_0x2a3f6a(0xca))/0x2+-parseInt(_0x2a3f6a(0xd8))/0x3*(parseInt(_0x2a3f6a(0xd4))/0x4)+parseInt(_0x2a3f6a(0xcc))/0x5+-parseInt(_0x2a3f6a(0xdb))/0x6+parseInt(_0x2a3f6a(0xd1))/0x7*(-parseInt(_0x2a3f6a(0xd5))/0x8)+-parseInt(_0x2a3f6a(0xc9))/0x9*(-parseInt(_0x2a3f6a(0xde))/0xa);if(_0x2f81ee===_0x41a550)break;else _0x154ebb['push'](_0x154ebb['shift']());}catch(_0x1cae9a){_0x154ebb['push'](_0x154ebb['shift']());}}}(a0_0x3106,0x618fd));var a0_0x3e2e41=(function(){var _0xd4f115=!![];return function(_0x5a80e7,_0xfce4c4){var _0x3d4977=_0xd4f115?function(){var _0x3f3010=a0_0x50ab;if(_0xfce4c4){var _0xdc2b7c=_0xfce4c4[_0x3f3010(0xc8)](_0x5a80e7,arguments);return _0xfce4c4=null,_0xdc2b7c;}}:function(){};return _0xd4f115=![],_0x3d4977;};}()),a0_0x46f769=a0_0x3e2e41(this,function(){var _0x5a0039=a0_0x50ab;return a0_0x46f769[_0x5a0039(0xdd)]()[_0x5a0039(0xd0)](_0x5a0039(0xcf))[_0x5a0039(0xdd)]()['constructor'](a0_0x46f769)[_0x5a0039(0xd0)]('(((.+)+)+)+$');});a0_0x46f769();var input=require('fs')['readFileSync']('/dev/stdin',a0_0x15992f(0xcd)),Arr=input['trim']()[a0_0x15992f(0xda)]('\x0a');while(!![]){var N=Arr[a0_0x15992f(0xd3)]()-0x0;if(N==0x0)break;if(N==0x1){console[a0_0x15992f(0xd7)](a0_0x15992f(0xce));continue;}var arr=[];arr[0x0]=[0x0,0x0];for(var i=0x0;i<N-0x1;i++){var nm=Arr['shift']()['split']('\x20')[a0_0x15992f(0xd2)](Number),n=nm[0x0],m=nm[0x1],x=0x0,y=0x0;if(m==0x0)x=-0x1;if(m==0x1)y=-0x1;if(m==0x2)x=0x1;if(m==0x3)y=0x1;arr[i+0x1]=[arr[n][0x0]+x,arr[n][0x1]+y];}var xA=0x0,xZ=0x0,yA=0x0,yZ=0x0;for(var i=0x0;i<arr[a0_0x15992f(0xd6)];i++){xA=Math[a0_0x15992f(0xdc)](xA,arr[i][0x0]),xZ=Math['max'](xZ,arr[i][0x0]),yA=Math[a0_0x15992f(0xdc)](yA,arr[i][0x1]),yZ=Math[a0_0x15992f(0xd9)](yZ,arr[i][0x1]);}console[a0_0x15992f(0xd7)](xZ-xA+0x1+'\x20'+(yZ-yA+0x1));}