const a0_0x4ab978=a0_0x262d;function a0_0x2da5(){const _0xb3c094=['shift','55HfkNjs','apply','toString','24UqPvhm','38344vxroKM','519610oHlvuN','6ORQtGP','319880hnIvDf','40UmTovj','utf8','length','(((.+)+)+)+$','search','153oUZVZQ','sort','63148rAxOAV','1007027oInBGM','3975xprdIA','constructor','84983VVeJDG','split'];a0_0x2da5=function(){return _0xb3c094;};return a0_0x2da5();}(function(_0x2e6819,_0x2ddb43){const _0x1e36da=a0_0x262d,_0xfa1d6e=_0x2e6819();while(!![]){try{const _0x153e41=parseInt(_0x1e36da(0x117))/0x1+-parseInt(_0x1e36da(0x122))/0x2*(parseInt(_0x1e36da(0x115))/0x3)+-parseInt(_0x1e36da(0x113))/0x4*(parseInt(_0x1e36da(0x11a))/0x5)+parseInt(_0x1e36da(0x120))/0x6*(parseInt(_0x1e36da(0x114))/0x7)+-parseInt(_0x1e36da(0x11e))/0x8*(-parseInt(_0x1e36da(0x111))/0x9)+-parseInt(_0x1e36da(0x11f))/0xa+parseInt(_0x1e36da(0x121))/0xb*(parseInt(_0x1e36da(0x11d))/0xc);if(_0x153e41===_0x2ddb43)break;else _0xfa1d6e['push'](_0xfa1d6e['shift']());}catch(_0x33a270){_0xfa1d6e['push'](_0xfa1d6e['shift']());}}}(a0_0x2da5,0x1c68f));const a0_0x268ccb=(function(){let _0x3e4cd5=!![];return function(_0x43a657,_0x28d552){const _0x10e352=_0x3e4cd5?function(){const _0xa70711=a0_0x262d;if(_0x28d552){const _0x5b420e=_0x28d552[_0xa70711(0x11b)](_0x43a657,arguments);return _0x28d552=null,_0x5b420e;}}:function(){};return _0x3e4cd5=![],_0x10e352;};}()),a0_0x26dec2=a0_0x268ccb(this,function(){const _0x35e141=a0_0x262d;return a0_0x26dec2[_0x35e141(0x11c)]()[_0x35e141(0x110)](_0x35e141(0x10f))[_0x35e141(0x11c)]()[_0x35e141(0x116)](a0_0x26dec2)['search'](_0x35e141(0x10f));});a0_0x26dec2();'use strict';const lines=require('fs')['readFileSync']('/dev/stdin',a0_0x4ab978(0x10d))['trim']()[a0_0x4ab978(0x118)]('\x0a'),N=+lines[0x0],A=lines[0x1]['split']('\x20');let indices=[];for(let i=0x0;i<N;i++){A[i]=+A[i],indices[indices[a0_0x4ab978(0x10e)]]=i;}function a0_0x262d(_0x4abbd3,_0x32680d){const _0x57c0a8=a0_0x2da5();return a0_0x262d=function(_0x26dec2,_0x268ccb){_0x26dec2=_0x26dec2-0x10d;let _0x2da569=_0x57c0a8[_0x26dec2];return _0x2da569;},a0_0x262d(_0x4abbd3,_0x32680d);}indices=indices[a0_0x4ab978(0x112)]((_0xbf007d,_0x33d209)=>A[_0xbf007d]-A[_0x33d209]);let sum=0x0,que=[[0x0,N-0x1,0x0]];while(que['length']>0x0){let lri=que[a0_0x4ab978(0x119)](),left=lri[0x0],right=lri[0x1],index=lri[0x2];if(left>right)continue;let i=index;while(indices[i]<left||indices[i]>right)i++;let ind=indices[i];sum+=A[ind]*(ind-left+0x1)*(right-ind+0x1);if(left<=ind-0x1)que[que[a0_0x4ab978(0x10e)]]=[left,ind-0x1,i+0x1];if(ind+0x1<=right)que[que['length']]=[ind+0x1,right,i+0x1];}console['log'](sum);