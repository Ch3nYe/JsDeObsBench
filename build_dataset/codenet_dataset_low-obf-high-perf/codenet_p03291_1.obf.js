function a0_0x3c6b(){var _0x2860ce=['56yZgNZM','length','1965960pnOTuZ','ABC','toString','search','1015otSxuA','split','stdin','(((.+)+)+)+$','apply','constructor','stdout','5382180vcmJEz','78835dIdTjo','813799AZiWOQ','149058SLANIv','log','6036460glvwvp','createInterface','778dybOIK','56WHidDE'];a0_0x3c6b=function(){return _0x2860ce;};return a0_0x3c6b();}var a0_0x44f8f2=a0_0x3efd;(function(_0xba4e0d,_0x39bf81){var _0x279553=a0_0x3efd,_0x3088b9=_0xba4e0d();while(!![]){try{var _0x237640=-parseInt(_0x279553(0x16e))/0x1*(parseInt(_0x279553(0x17c))/0x2)+-parseInt(_0x279553(0x178))/0x3+-parseInt(_0x279553(0x17d))/0x4*(parseInt(_0x279553(0x176))/0x5)+parseInt(_0x279553(0x16a))/0x6+parseInt(_0x279553(0x177))/0x7*(parseInt(_0x279553(0x17e))/0x8)+-parseInt(_0x279553(0x175))/0x9+parseInt(_0x279553(0x17a))/0xa;if(_0x237640===_0x39bf81)break;else _0x3088b9['push'](_0x3088b9['shift']());}catch(_0x590bf9){_0x3088b9['push'](_0x3088b9['shift']());}}}(a0_0x3c6b,0x75a22));var a0_0x53b022=(function(){var _0x28c3b6=!![];return function(_0x16f6f0,_0x533b3f){var _0x2ca9a9=_0x28c3b6?function(){var _0x1c9e24=a0_0x3efd;if(_0x533b3f){var _0x2ca509=_0x533b3f[_0x1c9e24(0x172)](_0x16f6f0,arguments);return _0x533b3f=null,_0x2ca509;}}:function(){};return _0x28c3b6=![],_0x2ca9a9;};}()),a0_0x3feb98=a0_0x53b022(this,function(){var _0x7c3f8e=a0_0x3efd;return a0_0x3feb98[_0x7c3f8e(0x16c)]()[_0x7c3f8e(0x16d)](_0x7c3f8e(0x171))[_0x7c3f8e(0x16c)]()[_0x7c3f8e(0x173)](a0_0x3feb98)[_0x7c3f8e(0x16d)](_0x7c3f8e(0x171));});function a0_0x3efd(_0xfc2a33,_0x368db6){var _0x54a41=a0_0x3c6b();return a0_0x3efd=function(_0x3feb98,_0x53b022){_0x3feb98=_0x3feb98-0x16a;var _0x3c6bc0=_0x54a41[_0x3feb98];return _0x3c6bc0;},a0_0x3efd(_0xfc2a33,_0x368db6);}a0_0x3feb98();var line,S,MOD=Math['pow'](0xa,0x9)+0x7,readline=require('readline'),rl=readline[a0_0x44f8f2(0x17b)]({'input':process[a0_0x44f8f2(0x170)],'output':process[a0_0x44f8f2(0x174)]});rl['on']('line',function(_0x166585){line=_0x166585;}),rl['on']('close',function(){var _0x2fbae5=a0_0x44f8f2;S=line[_0x2fbae5(0x16f)](''),dp=Array(S[_0x2fbae5(0x17f)]+0x1);for(var _0x3ad666=0x0;_0x3ad666<=S[_0x2fbae5(0x17f)];_0x3ad666++){dp[_0x3ad666]=Array(0x3+0x1)['fill'](0x0);}for(var _0x3ad666=S[_0x2fbae5(0x17f)];_0x3ad666>=0x0;_0x3ad666--){for(var _0x1810dc=0x3;_0x1810dc>=0x0;_0x1810dc--){_0x3ad666===S[_0x2fbae5(0x17f)]?dp[_0x3ad666][_0x1810dc]=_0x1810dc===0x3?0x1:0x0:(dp[_0x3ad666][_0x1810dc]=dp[_0x3ad666+0x1][_0x1810dc]*(S[_0x3ad666]==='?'?0x3:0x1),_0x1810dc<0x3&&(S[_0x3ad666]==='?'||S[_0x3ad666]===_0x2fbae5(0x16b)[_0x1810dc])&&(dp[_0x3ad666][_0x1810dc]+=dp[_0x3ad666+0x1][_0x1810dc+0x1]),dp[_0x3ad666][_0x1810dc]%=MOD);}}console[_0x2fbae5(0x179)](dp[0x0][0x0]);});